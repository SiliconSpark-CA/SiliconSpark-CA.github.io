<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>3D Molecular Models</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            overflow: hidden;
            font-family: Arial, sans-serif;
            background-color: #f0f0f0;
        }
        
        #container {
            width: 100vw;
            height: 100vh;
            position: relative;
        }
        
        #info {
            position: absolute;
            top: 10px;
            left: 10px;
            color: #333;
            background-color: rgba(255, 255, 255, 0.8);
            padding: 15px;
            border-radius: 8px;
            max-width: 320px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        #controls {
            position: absolute;
            bottom: 10px;
            left: 10px;
            color: #333;
            background-color: rgba(255, 255, 255, 0.8);
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        #molecule-selector {
            position: absolute;
            top: 10px;
            right: 10px;
            background-color: rgba(255, 255, 255, 0.8);
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .molecule-btn {
            display: block;
            width: 100%;
            padding: 8px 12px;
            margin: 5px 0;
            background-color: #4a90e2;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            transition: background-color 0.3s;
        }
        
        .molecule-btn:hover {
            background-color: #357abd;
        }
        
        .molecule-btn.active {
            background-color: #2c5aa0;
        }
        
        h3 {
            margin-top: 0;
            color: #2c5aa0;
        }
        
        .atom-legend {
            display: flex;
            align-items: center;
            margin: 5px 0;
        }
        
        .color-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            margin-right: 8px;
        }
    </style>
</head>
<body>
    <div id="container">
        <div id="info">
            <h3 id="molecule-title">H₂O (Water) Molecule</h3>
            <div id="molecule-info">
                <div class="atom-legend">
                    <div class="color-dot" style="background-color: #ff0000;"></div>
                    <span>Red: Oxygen (O)</span>
                </div>
                <div class="atom-legend">
                    <div class="color-dot" style="background-color: #ffffff;"></div>
                    <span>White: Hydrogen (H)</span>
                </div>
                <p>Bond angle: 104.5°</p>
            </div>
        </div>
        
        <div id="controls">
            <p><strong>Controls:</strong></p>
            <p>Mouse: Rotate view</p>
            <p>Scroll: Zoom in/out</p>
        </div>
        
        <div id="molecule-selector">
            <h3>Select Molecule</h3>
            <button class="molecule-btn active" data-molecule="h2o">H₂O (Water)</button>
            <button class="molecule-btn" data-molecule="o2">O₂ (Oxygen)</button>
            <button class="molecule-btn" data-molecule="co2">CO₂ (Carbon Dioxide)</button>
            <button class="molecule-btn" data-molecule="glucose">C₆H₁₂O₆ (Glucose)</button>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/controls/OrbitControls.js"></script>
    
    <script>
        // Initialize the scene, camera, and renderer
        const scene = new THREE.Scene();
        scene.background = new THREE.Color(0xf0f0f0);
        
        const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
        camera.position.set(0, 0, 8);
        
        const renderer = new THREE.WebGLRenderer({ antialias: true });
        renderer.setSize(window.innerWidth, window.innerHeight);
        renderer.setPixelRatio(window.devicePixelRatio);
        document.getElementById('container').appendChild(renderer.domElement);
        
        // Add orbit controls for interactive camera movement
        const controls = new THREE.OrbitControls(camera, renderer.domElement);
        controls.enableDamping = true;
        controls.dampingFactor = 0.05;
        
        // Add lighting
        const ambientLight = new THREE.AmbientLight(0xffffff, 0.5);
        scene.add(ambientLight);
        
        const directionalLight = new THREE.DirectionalLight(0xffffff, 0.8);
        directionalLight.position.set(1, 1, 1);
        scene.add(directionalLight);
        
        // Current molecule group
        let currentMolecule = null;
        
        // Create atom with label
        function createAtom(color, radius, position, label) {
            const geometry = new THREE.SphereGeometry(radius, 32, 32);
            const material = new THREE.MeshPhongMaterial({ 
                color: color,
                shininess: 100,
                transparent: true,
                opacity: 0.9
            });
            const atom = new THREE.Mesh(geometry, material);
            atom.position.copy(position);
            
            // Create label
            const canvas = document.createElement('canvas');
            const context = canvas.getContext('2d');
            canvas.width = 64;
            canvas.height = 64;
            
            context.font = 'bold 48px Arial';
            context.fillStyle = 'black';
            context.textAlign = 'center';
            context.textBaseline = 'middle';
            context.fillText(label, canvas.width / 2, canvas.height / 2);
            
            const texture = new THREE.CanvasTexture(canvas);
            const spriteMaterial = new THREE.SpriteMaterial({ map: texture });
            const sprite = new THREE.Sprite(spriteMaterial);
            sprite.position.copy(position);
            sprite.position.z += radius + 0.5;
            sprite.scale.set(0.7, 0.7, 1);
            
            return { atom, sprite };
        }
        
        // Create bond
        function createBond(start, end, radius = 0.1, color = 0xaaaaaa) {
            const direction = new THREE.Vector3().subVectors(end, start);
            const length = direction.length();
            const geometry = new THREE.CylinderGeometry(radius, radius, length, 16);
            const material = new THREE.MeshPhongMaterial({ 
                color: color,
                shininess: 50
            });
            const bond = new THREE.Mesh(geometry, material);
            
            // Position bond at midpoint
            bond.position.copy(start).add(end).multiplyScalar(0.5);
            
            // Orient bond to point from start to end
            bond.lookAt(end);
            bond.rotateX(Math.PI / 2);
            
            return bond;
        }
        
        // Create water molecule
        function createWaterMolecule() {
            const molecule = new THREE.Group();
            
            // Water molecule geometry parameters
            const bondLength = 1.5;  // Scaled for visualization
            const bondAngle = 104.5 * Math.PI / 180;  // Convert to radians
            
            // Create Oxygen atom (red, larger)
            const oxygen = createAtom(0xff0000, 0.8, new THREE.Vector3(0, 0, 0), "O");
            molecule.add(oxygen.atom);
            molecule.add(oxygen.sprite);
            
            // Create Hydrogen atoms (white, smaller)
            const hydrogen1Pos = new THREE.Vector3(
                bondLength * Math.sin(bondAngle / 2),
                bondLength * Math.cos(bondAngle / 2),
                0
            );
            const hydrogen1 = createAtom(0xffffff, 0.4, hydrogen1Pos, "H");
            molecule.add(hydrogen1.atom);
            molecule.add(hydrogen1.sprite);
            
            const hydrogen2Pos = new THREE.Vector3(
                -bondLength * Math.sin(bondAngle / 2),
                bondLength * Math.cos(bondAngle / 2),
                0
            );
            const hydrogen2 = createAtom(0xffffff, 0.4, hydrogen2Pos, "H");
            molecule.add(hydrogen2.atom);
            molecule.add(hydrogen2.sprite);
            
            // Create bonds
            const bond1 = createBond(
                new THREE.Vector3(0, 0, 0),
                hydrogen1Pos
            );
            molecule.add(bond1);
            
            const bond2 = createBond(
                new THREE.Vector3(0, 0, 0),
                hydrogen2Pos
            );
            molecule.add(bond2);
            
            return molecule;
        }
        
        // Create oxygen molecule (O2)
        function createOxygenMolecule() {
            const molecule = new THREE.Group();
            
            const bondLength = 1.8;  // Scaled for visualization
            
            // Create two Oxygen atoms (red)
            const oxygen1 = createAtom(0xff0000, 0.8, new THREE.Vector3(-bondLength/2, 0, 0), "O");
            molecule.add(oxygen1.atom);
            molecule.add(oxygen1.sprite);
            
            const oxygen2 = createAtom(0xff0000, 0.8, new THREE.Vector3(bondLength/2, 0, 0), "O");
            molecule.add(oxygen2.atom);
            molecule.add(oxygen2.sprite);
            
            // Create double bond (two parallel bonds)
            const bond1 = createBond(
                new THREE.Vector3(-bondLength/2, 0, 0),
                new THREE.Vector3(bondLength/2, 0, 0),
                0.1
            );
            molecule.add(bond1);
            
            const bond2 = createBond(
                new THREE.Vector3(-bondLength/2, 0.2, 0),
                new THREE.Vector3(bondLength/2, 0.2, 0),
                0.1
            );
            molecule.add(bond2);
            
            return molecule;
        }
        
        // Create carbon dioxide molecule (CO2)
        function createCO2Molecule() {
            const molecule = new THREE.Group();
            
            const bondLength = 1.8;  // Scaled for visualization
            
            // Create Carbon atom (gray, medium)
            const carbon = createAtom(0x333333, 0.7, new THREE.Vector3(0, 0, 0), "C");
            molecule.add(carbon.atom);
            molecule.add(carbon.sprite);
            
            // Create Oxygen atoms (red, larger)
            const oxygen1 = createAtom(0xff0000, 0.8, new THREE.Vector3(-bondLength, 0, 0), "O");
            molecule.add(oxygen1.atom);
            molecule.add(oxygen1.sprite);
            
            const oxygen2 = createAtom(0xff0000, 0.8, new THREE.Vector3(bondLength, 0, 0), "O");
            molecule.add(oxygen2.atom);
            molecule.add(oxygen2.sprite);
            
            // Create double bonds (two parallel bonds for each C=O)
            // First double bond (C-O1)
            const bond1_1 = createBond(
                new THREE.Vector3(0, 0, 0),
                new THREE.Vector3(-bondLength, 0, 0),
                0.1
            );
            molecule.add(bond1_1);
            
            const bond1_2 = createBond(
                new THREE.Vector3(0, 0.15, 0),
                new THREE.Vector3(-bondLength, 0.15, 0),
                0.1
            );
            molecule.add(bond1_2);
            
            // Second double bond (C-O2)
            const bond2_1 = createBond(
                new THREE.Vector3(0, 0, 0),
                new THREE.Vector3(bondLength, 0, 0),
                0.1
            );
            molecule.add(bond2_1);
            
            const bond2_2 = createBond(
                new THREE.Vector3(0, -0.15, 0),
                new THREE.Vector3(bondLength, -0.15, 0),
                0.1
            );
            molecule.add(bond2_2);
            
            return molecule;
        }
        
        // Create glucose molecule (C6H12O6)
        function createGlucoseMolecule() {
            const molecule = new THREE.Group();
            
            // Simplified glucose structure (ring form)
            const radius = 2.5;  // Ring radius
            const bondLength = 1.2;  // Bond length
            const atoms = [];
            
            // Create ring atoms (5 carbons and 1 oxygen)
            for (let i = 0; i < 6; i++) {
                const angle = (i / 6) * Math.PI * 2;
                const x = Math.cos(angle) * radius;
                const y = Math.sin(angle) * radius;
                
                // Position 5 is oxygen, others are carbons
                if (i === 5) {
                    const oxygen = createAtom(0xff0000, 0.7, new THREE.Vector3(x, y, 0), "O");
                    atoms.push(oxygen);
                    molecule.add(oxygen.atom);
                    molecule.add(oxygen.sprite);
                } else {
                    const carbon = createAtom(0x333333, 0.6, new THREE.Vector3(x, y, 0), "C");
                    atoms.push(carbon);
                    molecule.add(carbon.atom);
                    molecule.add(carbon.sprite);
                }
            }
            
            // Create ring bonds
            for (let i = 0; i < 6; i++) {
                const next = (i + 1) % 6;
                const bond = createBond(
                    atoms[i].atom.position,
                    atoms[next].atom.position
                );
                molecule.add(bond);
            }
            
            // Add OH groups to carbons (simplified)
            for (let i = 0; i < 5; i++) {
                const angle = (i / 6) * Math.PI * 2 + Math.PI / 6;
                const x = Math.cos(angle) * (radius + bondLength);
                const y = Math.sin(angle) * (radius + bondLength);
                
                const oxygen = createAtom(0xff0000, 0.5, new THREE.Vector3(x, y, 0), "O");
                molecule.add(oxygen.atom);
                molecule.add(oxygen.sprite);
                
                // Bond from carbon to oxygen
                const bond = createBond(
                    atoms[i].atom.position,
                    oxygen.atom.position
                );
                molecule.add(bond);
                
                // Add hydrogen to OH
                const hPos = new THREE.Vector3(
                    x + Math.cos(angle) * 0.8,
                    y + Math.sin(angle) * 0.8,
                    0
                );
                const hydrogen = createAtom(0xffffff, 0.3, hPos, "H");
                molecule.add(hydrogen.atom);
                molecule.add(hydrogen.sprite);
                
                const hBond = createBond(
                    oxygen.atom.position,
                    hydrogen.atom.position
                );
                molecule.add(hBond);
            }
            
            // Add CH2OH group to carbon 5
            const ch2Angle = (5 / 6) * Math.PI * 2 + Math.PI / 6;
            const ch2X = Math.cos(ch2Angle) * (radius + bondLength);
            const ch2Y = Math.sin(ch2Angle) * (radius + bondLength);
            
            const carbon6 = createAtom(0x333333, 0.5, new THREE.Vector3(ch2X, ch2Y, 0), "C");
            molecule.add(carbon6.atom);
            molecule.add(carbon6.sprite);
            
            const bond6 = createBond(
                atoms[5].atom.position,
                carbon6.atom.position
            );
            molecule.add(bond6);
            
            // Add OH to carbon6
            const ohAngle = ch2Angle + Math.PI / 4;
            const ohX = ch2X + Math.cos(ohAngle) * bondLength;
            const ohY = ch2Y + Math.sin(ohAngle) * bondLength;
            
            const oxygen6 = createAtom(0xff0000, 0.4, new THREE.Vector3(ohX, ohY, 0), "O");
            molecule.add(oxygen6.atom);
            molecule.add(oxygen6.sprite);
            
            const bondOh = createBond(
                carbon6.atom.position,
                oxygen6.atom.position
            );
            molecule.add(bondOh);
            
            // Add H to OH
            const h6Pos = new THREE.Vector3(
                ohX + Math.cos(ohAngle) * 0.7,
                ohY + Math.sin(ohAngle) * 0.7,
                0
            );
            const hydrogen6 = createAtom(0xffffff, 0.25, h6Pos, "H");
            molecule.add(hydrogen6.atom);
            molecule.add(hydrogen6.sprite);
            
            const bondH6 = createBond(
                oxygen6.atom.position,
                hydrogen6.atom.position
            );
            molecule.add(bondH6);
            
            // Add two hydrogens to carbon6
            const h1Angle = ch2Angle - Math.PI / 4;
            const h1X = ch2X + Math.cos(h1Angle) * 0.7;
            const h1Y = ch2Y + Math.sin(h1Angle) * 0.7;
            
            const hydrogen1 = createAtom(0xffffff, 0.25, new THREE.Vector3(h1X, h1Y, 0), "H");
            molecule.add(hydrogen1.atom);
            molecule.add(hydrogen1.sprite);
            
            const bondH1 = createBond(
                carbon6.atom.position,
                hydrogen1.atom.position
            );
            molecule.add(bondH1);
            
            const h2Angle = ch2Angle + Math.PI;
            const h2X = ch2X + Math.cos(h2Angle) * 0.7;
            const h2Y = ch2Y + Math.sin(h2Angle) * 0.7;
            
            const hydrogen2 = createAtom(0xffffff, 0.25, new THREE.Vector3(h2X, h2Y, 0), "H");
            molecule.add(hydrogen2.atom);
            molecule.add(hydrogen2.sprite);
            
            const bondH2 = createBond(
                carbon6.atom.position,
                hydrogen2.atom.position
            );
            molecule.add(bondH2);
            
            return molecule;
        }
        
        // Update info panel based on selected molecule
        function updateInfoPanel(moleculeType) {
            const title = document.getElementById('molecule-title');
            const info = document.getElementById('molecule-info');
            
            switch(moleculeType) {
                case 'h2o':
                    title.textContent = 'H₂O (Water) Molecule';
                    info.innerHTML = `
                        <div class="atom-legend">
                            <div class="color-dot" style="background-color: #ff0000;"></div>
                            <span>Red: Oxygen (O)</span>
                        </div>
                        <div class="atom-legend">
                            <div class="color-dot" style="background-color: #ffffff;"></div>
                            <span>White: Hydrogen (H)</span>
                        </div>
                        <p>Bond angle: 104.5°</p>
                    `;
                    break;
                case 'o2':
                    title.textContent = 'O₂ (Oxygen) Molecule';
                    info.innerHTML = `
                        <div class="atom-legend">
                            <div class="color-dot" style="background-color: #ff0000;"></div>
                            <span>Red: Oxygen (O)</span>
                        </div>
                        <p>Double bond between oxygen atoms</p>
                    `;
                    break;
                case 'co2':
                    title.textContent = 'CO₂ (Carbon Dioxide) Molecule';
                    info.innerHTML = `
                        <div class="atom-legend">
                            <div class="color-dot" style="background-color: #ff0000;"></div>
                            <span>Red: Oxygen (O)</span>
                        </div>
                        <div class="atom-legend">
                            <div class="color-dot" style="background-color: #333333;"></div>
                            <span>Dark Gray: Carbon (C)</span>
                        </div>
                        <p>Linear structure with double bonds</p>
                        <p>Bond angle: 180°</p>
                    `;
                    break;
                case 'glucose':
                    title.textContent = 'C₆H₁₂O₆ (Glucose) Molecule';
                    info.innerHTML = `
                        <div class="atom-legend">
                            <div class="color-dot" style="background-color: #ff0000;"></div>
                            <span>Red: Oxygen (O)</span>
                        </div>
                        <div class="atom-legend">
                            <div class="color-dot" style="background-color: #333333;"></div>
                            <span>Dark Gray: Carbon (C)</span>
                        </div>
                        <div class="atom-legend">
                            <div class="color-dot" style="background-color: #ffffff;"></div>
                            <span>White: Hydrogen (H)</span>
                        </div>
                        <p>Ring structure with OH groups</p>
                    `;
                    break;
            }
        }
        
        // Load molecule
        function loadMolecule(type) {
            // Remove current molecule
            if (currentMolecule) {
                scene.remove(currentMolecule);
            }
            
            // Create new molecule
            switch(type) {
                case 'h2o':
                    currentMolecule = createWaterMolecule();
                    break;
                case 'o2':
                    currentMolecule = createOxygenMolecule();
                    break;
                case 'co2':
                    currentMolecule = createCO2Molecule();
                    break;
                case 'glucose':
                    currentMolecule = createGlucoseMolecule();
                    break;
            }
            
            scene.add(currentMolecule);
            updateInfoPanel(type);
            
            // Adjust camera based on molecule size
            switch(type) {
                case 'h2o':
                    camera.position.set(0, 0, 8);
                    break;
                case 'o2':
                    camera.position.set(0, 0, 8);
                    break;
                case 'co2':
                    camera.position.set(0, 0, 10);
                    break;
                case 'glucose':
                    camera.position.set(0, 0, 12);
                    break;
            }
            controls.update();
        }
        
        // Initial molecule
        loadMolecule('h2o');
        
        // Molecule selector buttons
        const buttons = document.querySelectorAll('.molecule-btn');
        buttons.forEach(button => {
            button.addEventListener('click', () => {
                // Update active button
                buttons.forEach(btn => btn.classList.remove('active'));
                button.classList.add('active');
                
                // Load selected molecule
                loadMolecule(button.dataset.molecule);
            });
        });
        
        // Add a subtle animation
        function animate() {
            requestAnimationFrame(animate);
            
            // Slowly rotate the molecule for better visualization
            if (currentMolecule) {
                currentMolecule.rotation.y += 0.005;
            }
            
            controls.update();
            renderer.render(scene, camera);
        }
        
        // Handle window resize
        window.addEventListener('resize', () => {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        });
        
        // Start the animation
        animate();
    </script>
</body>
</html>
